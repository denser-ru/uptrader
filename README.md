# Древовидное Меню Django - tree_menu

## Описание

Была поставлена задача:

Нужно сделать django app, который будет реализовывать древовидное меню, соблюдая следующие условия:
1) Меню реализовано через template tag
2) Все, что над выделенным пунктом - развернуто. Первый уровень вложенности под выделенным пунктом тоже развернут.
3) Хранится в БД.
4) Редактируется в стандартной админке Django
5) Активный пункт меню определяется исходя из URL текущей страницы
6) Меню на одной странице может быть несколько. Они определяются по названию.
7) При клике на меню происходит переход по заданному в нем URL. URL может быть задан как явным образом, так и через named url.
8) На отрисовку каждого меню требуется ровно 1 запрос к БД
 Нужен django-app, который позволяет вносить в БД меню (одно или несколько) через админку, и нарисовать на любой нужной странице меню по названию.
 {% draw_menu 'main_menu' %}
 При выполнении задания из библиотек следует использовать только Django и стандартную библиотеку Python

## Реализация

1) Меню реализовано через template tag: использовал simple_tag для создания тега draw_menu, который рендерит меню.
2) Все, что над выделенным пунктом - развернуто: Функция mark_active устанавливает активные элементы и их детей, что соответствует требованию.
3) Хранится в БД: Модели MenuBlock и MenuItem хранят информацию о меню в базе данных.
4) Редактируется в стандартной админке Django: Модели зарегистрированы в админке, что позволяет их редактировать.
5) Активный пункт меню определяется исходя из URL текущей страницы: Функция mark_active использует request.path для определения активного пункта.
6) Меню на одной странице может быть несколько: Тег draw_menu принимает параметр menu_block_name, что позволяет отрисовывать разные меню.
7) При клике на меню происходит переход по заданному в нем URL: Модель MenuItem содержит поле url, которое используется для перехода.
8) На отрисовку каждого меню требуется ровно 1 запрос к БД: Использование prefetch_related в запросе к MenuItem позволяет извлекать все необходимые данные одним запросом.

## Установка и Запуск

Для установки и запуска приложения используйте предоставленный скрипт `init.sh`:

```bash
./init.sh - Этот скрипт установит необходимые зависимости, создаст суперпользователя, выполнит миграции, соберет статические файлы и загрузит примеры меню в базу данных.
./start - Этот скрипт запускает приложение, когда уже проведена установка
```
```
http сервер приложения запускается по адрсу http://127.0.0.1:8000
адрес админки http://127.0.0.1:8000/admin
```
Создаётся супер пользователь с данными для входа:
```
loging: admin
password: admin
```

## Использование
Чтобы добавить меню в шаблон, используйте следующий template tag:

```
{% draw_menu 'main_menu' %}
```
В качестве примера в шаблон главной страницы добавил второй блок меню
```
### tree_menu/templates/home.html:
...
{% block footer %}
    {% draw_menu 'second_menu' %}
{% endblock %}
```

## Настройка
Вы можете настроить стили меню в соответствии с вашими предпочтениями, добавив CSS в ваш шаблон или внешний файл стилей.

Для темизации/шаблонизации меню созданы файлы:
```
tree_menu/templates/tree_menu/base_menu.html
tree_menu/templates/tree_menu/tree_menu.html
```

Для удобства тестирования добавил flatpages, что бы можно было удобно создавать страницы под пункты меню из админки.
В качестве примера, так же, создан шаблон главной страницы
```
tree_menu/templates/home.html
```

В админке элементы меню группируются в блоки меню, в которых и задаётся имя, которое можно использовать для вставки в шаблоны.

## Деинсталляция
Если вам нужно удалить приложение и очистить проект, выполните скрипт деинсталляции:
```
./uninstall.sh
```
Этот скрипт удалит все миграции, базу данных, собранные статические файлы и файлы кэша.

## Лицензия
Это программное обеспечение распространяется под лицензией MIT.